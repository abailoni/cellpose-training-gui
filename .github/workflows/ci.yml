#name: ci
#
#on:
#  push:
#    branches:
#      - '*'
#
#  pull_request:
#    branches:
#      - '*'
#
##  schedule:
##    - cron: '0 0 * * *'
#
##env:
##  CACHE_NUMBER: 0  # increase to reset cache manually
#
#jobs:
#  pip-tests:
#    strategy:
#      matrix:
#        include:
#          - os: ubuntu-latest
#            label: linux-64
#
##          - os: macos-latest
##            label: osx-64
##            prefix: /Users/runner/miniconda3/envs/my-env
##
##          - os: windows-latest
##            label: win-64
#
#    name: ${{ matrix.label }}
#    runs-on: ${{ matrix.os }}
#    steps:
#      - uses: actions/checkout@v3
#      - name: Set up Python
#        uses: actions/setup-python@v4
#        with:
#          python-version: '3.8'
#      - name: Install dependencies
#        run: |
#          python -m pip install --upgrade pip
#          pip install -r ./requirements.txt -r ./requirements-dev.txt
#      - name: Test with pytest
#        run: |
#          pip install pytest
#          pip install pytest-cov
#          pytest ./tests --doctest-modules --junitxml=junit/test-results.xml --cov=com --cov-report=xml --cov-report=html
#
##
##
##
##  #  Not working yet
##  test-using-mamba:
##
##    strategy:
##      matrix:
##        include:
##          - os: ubuntu-latest
##            label: linux-64
##            prefix: /usr/share/miniconda3/envs/my-env
##
###          - os: macos-latest
###            label: osx-64
###            prefix: /Users/runner/miniconda3/envs/my-env
###
###          - os: windows-latest
###            label: win-64
###            prefix: C:\Miniconda3\envs\my-env
##
##    name: ${{ matrix.label }}
##    runs-on: ${{ matrix.os }}
##    steps:
##      - uses: actions/checkout@v2
##
##      - name: Setup Mambaforge
##        uses: conda-incubator/setup-miniconda@v2
##        with:
##            miniforge-variant: Mambaforge
##            miniforge-version: latest
##            activate-environment: my-env
##            use-mamba: true
##
###      - name: Set cache date
###        run: echo "DATE=$(date +'%Y%m%d')" >> $GITHUB_ENV
###
###      - uses: actions/cache@v2
###        with:
###          path: ${{ matrix.prefix }}
###          key: ${{ matrix.label }}-conda-${{ hashFiles('environment.yml') }}-${{ env.DATE }}-${{ env.CACHE_NUMBER }}
###        id: cache
###          mamba env update -n my-env -f environment.yml
##
##      - name: Update environment
##        run:  |
##              pip install --no-cache-dir -r ./requirements.txt -r ./requirements-dev.txt
##              python setup.py install
##              mamba list
##              mamba info --all
###        if: steps.cache.outputs.cache-hit != 'true'
###
###      - name: Install PtAC (name of my own python package)
###          run: |
###            python setup.py install
###            conda list
###            conda info --all
##
##      - name: Run tests
##        shell: bash -l {0}
##        run: pytest ./tests
